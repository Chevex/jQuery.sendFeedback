{"ts":1339083321061,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"ï»¿//    Licensed to the Apache Software Foundation (ASF) under one\r\n//    or more contributor license agreements.  See the NOTICE file\r\n//    distributed with this work for additional information\r\n//    regarding copyright ownership.  The ASF licenses this file\r\n//    to you under the Apache License, Version 2.0 (the\r\n//    \"License\"); you may not use this file except in compliance\r\n//    with the License.  You may obtain a copy of the License at\r\n//\r\n//        http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n//    Unless required by applicable law or agreed to in writing,\r\n//    software distributed under the License is distributed on an\r\n//    \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n//    KIND, either express or implied.  See the License for the\r\n//    specific language governing permissions and limitations\r\n//    under the License.\r\n\r\n(function ($) {\r\n    $.sendFeedback = function (options) {\r\n        var settings = $.extend({\r\n            instructionText: 'Use Your Mouse to Highlight Areas on the Page',\r\n            instructionTextColor: '#f00',\r\n            instructionBackgroundColor: '#fff',\r\n            instructionTextSize: '40px',\r\n            overlayColor: '#000',\r\n            overlayOpacity: '.25',\r\n            overlayZIndex: '9000000',\r\n            highlightBorderColor: '#f00',\r\n            highlightBorderWidth: '3px',\r\n            highlightBorderStyle: 'solid',\r\n            highlightBorderRadius: '5px',\r\n            formTitle: 'Send Feedback',\r\n            formText: 'Your feedback is very useful to us when resolving problems. Please be very detailed in your description.',\r\n            formTextColor: '#000',\r\n            formBackgroundColor: '#fff',\r\n            formBorderColor: '#000',\r\n            formBorderWidth: '1px',\r\n            formBorderStyle: 'solid',\r\n            subjectText: 'Subject',\r\n            detailsText: 'Details'\r\n        }, options);\r\n\r\n        var $feedbackContainer = $('<div></div>').appendTo('body');\r\n\r\n        var $feedbackHighlights = $('<div></div>').appendTo('body');\r\n\r\n        var $feedbackOverlay = $('<div></div>')\r\n        .css({\r\n            position: 'absolute',\r\n            width: '100%',\r\n            height: '100%',\r\n            backgroundColor: settings.overlayColor,\r\n            opacity: settings.overlayOpacity,\r\n            left: '0',\r\n            top: '0',\r\n            zIndex: settings.overlayZIndex,\r\n            textAlign: 'center'\r\n        })\r\n        .appendTo($feedbackHighlights);\r\n\r\n        var $feedbackInstructions = $('<div></div>').css({\r\n            position: 'absolute',\r\n            width: '100%',\r\n            left: '0',\r\n            top: '35%',\r\n            zIndex: settings.overlayZIndex - 1,\r\n            textAlign: 'center',\r\n            fontSize: settings.instructionTextSize,\r\n            fontWeight: 'bold',\r\n            color: settings.instructionTextColor,\r\n            fontFamily: 'Arial',\r\n            backgroundColor: settings.instructionBackgroundColor,\r\n            padding: '10px'\r\n        })\r\n        .text(settings.instructionText)\r\n        .appendTo($feedbackContainer)\r\n        .hide();\r\n\r\n        var $feedbackForm = $('<div></div>').css({\r\n            position: 'fixed',\r\n            bottom: '0',\r\n            right: '0',\r\n            width: '275px',\r\n            height: '335px',\r\n            padding: '10px',\r\n            color: settings.formTextColor,\r\n            backgroundColor: settings.formBackgroundColor,\r\n            borderStyle: settings.formBorderStyle,\r\n            borderWidth: settings.formBorderWidth,\r\n            borderColor: settings.formBorderColor,\r\n            borderRadius: '10px 0 0 0',\r\n            zIndex: settings.overlayZIndex + 1\r\n        });\r\n        $('<div></div>').css({\r\n            fontSize: '20px',\r\n            textAlign: 'center',\r\n            marginBottom: '10px'\r\n        })\r\n        .text(settings.formTitle)\r\n        .appendTo($feedbackForm);\r\n        $('<div></div>')\r\n        .css({\r\n            fontSize: '11px',\r\n            marginBottom: '10px'\r\n        })\r\n        .text(settings.formText)\r\n        .appendTo($feedbackForm);\r\n        $('<div></div>')\r\n        .css({\r\n            fontSize: '11px'\r\n        })\r\n        .text(settings.subjectText)\r\n        .appendTo($feedbackForm);\r\n        var $feedbackSubject = $('<input type=\"text\" />').css({\r\n            width: '270px',\r\n            marginBottom: '10px',\r\n            display: 'block'\r\n        })\r\n        .appendTo($feedbackForm);\r\n        $('<div></div>')\r\n        .css({\r\n            fontSize: '11px'\r\n        })\r\n        .text(settings.detailsText)\r\n        .appendTo($feedbackForm);\r\n        var $feedbackDetails = $('<textarea></textarea>').css({\r\n            width: '270px',\r\n            height: '150px',\r\n            marginBottom: '10px',\r\n            display: 'block'\r\n        })\r\n        .appendTo($feedbackForm);\r\n        $('<input type=\"button\" value=\"Send\" />').click(function (e) {\r\n            $feedbackContainer.remove();\r\n            $('*').each(function () {\r\n                if ($(this).attr('style'))\r\n                    $(this).data('oldStyle', $(this).attr('style'));\r\n                else\r\n                    $(this).data('oldStyle', 'none');\r\n                $(this).width($(this).width());\r\n                $(this).height($(this).height());\r\n            });\r\n            var html = '<html>' + $('html').html() + '</html>';\r\n            $('*').each(function () {\r\n                if ($(this).data('oldStyle') != 'none')\r\n                    $(this).attr('style', $(this).data('oldStyle'));\r\n                else\r\n                    $(this).removeAttr('style');\r\n            });\r\n            $feedbackHighlights.remove();\r\n            var feedbackInformation = {\r\n                url: document.URL,\r\n                userAgent: navigator.userAgent,\r\n                subject: $feedbackSubject.val(),\r\n                details: $feedbackDetails.val(),\r\n                html: html\r\n            };\r\n            if (settings.feedbackSent)\r\n                settings.feedbackSent(feedbackInformation);\r\n        })\r\n        .appendTo($feedbackForm);\r\n        $('<input type=\"button\" value=\"Cancel\" />').click(function (e) {\r\n            $feedbackContainer.remove();\r\n            $feedbackHighlights.remove();\r\n        })\r\n        .appendTo($feedbackForm);\r\n        $feedbackForm.appendTo($feedbackContainer);\r\n\r\n        var originalCoords = { top: 0, left: 0 };\r\n\r\n        var $currentHighlight;\r\n\r\n        $feedbackOverlay.bind('mousedown', function (e) {\r\n            $feedbackForm.fadeOut();\r\n            $currentHighlight = $('<div></div>').css({\r\n                width: '1px',\r\n                height: '1px',\r\n                borderStyle: settings.highlightBorderStyle,\r\n                borderWidth: settings.highlightBorderWidth,\r\n                borderColor: settings.highlightBorderColor,\r\n                borderRadius: settings.highlightBorderRadius,\r\n                position: 'absolute',\r\n                left: e.pageX,\r\n                top: e.pageY,\r\n                zIndex: settings.overlayZIndex - 1\r\n            })\r\n            .appendTo($feedbackHighlights);\r\n            originalCoords = { top: e.pageY, left: e.pageX };\r\n        });\r\n\r\n        $feedbackOverlay.bind('mousemove', function (e) {\r\n            if ($currentHighlight) {\r\n                var newCoords = { top: e.pageY, left: e.pageX };\r\n\r\n                if (newCoords.top < originalCoords.top) $currentHighlight.css('top', newCoords.top);\r\n                if (newCoords.left < originalCoords.left) $currentHighlight.css('left', newCoords.left);\r\n\r\n                $currentHighlight.height(Math.abs(newCoords.top - originalCoords.top));\r\n                $currentHighlight.width(Math.abs(newCoords.left - originalCoords.left));\r\n            }\r\n        });\r\n\r\n        $feedbackOverlay.bind('mouseup', function (e) {\r\n            $feedbackForm.fadeIn();\r\n            $currentHighlight = null;\r\n        });\r\n\r\n        $feedbackInstructions.fadeIn(500, function () {\r\n            setTimeout(function () {\r\n                $feedbackInstructions.fadeOut(1000);\r\n            }, 2000);\r\n        });\r\n\r\n        $feedbackOverlay.height($(document).height());\r\n    }\r\n})(jQuery);"]],"start1":0,"start2":0,"length1":0,"length2":8208}]],"length":8208}
